<html>
<head>
<title>Image Repository</title>
<script language="javascript">
function hideImgProp(){
  parent.document.all.frmimage.style.height = '92px';
  document.all.imgProperties.style.visibility = 'hidden';
}
function loadImgProp(img, path){
  var tds = document.all.tblContainer.getElementsByTagName("TD");
  for (var i = 0; i < tds.length; ++i){
     tds[i].style.border = 'none';
     tds[i].style.backgroundColor = '#FFFFFF';
  }
  var td = img.parentElement;
  td.style.border = '1px solid #7B9BBA';
  td.style.backgroundColor = '#334488';
  document.frmProp.filepath.value = path;
  parent.document.all.frmimage.style.height = '92px';
  insertImage();
}
function insertImage(alt, width, height){
  var frm = document.frmProp;
  var path = frm.filepath.value;
  var width = frm.width.value;
  var height = frm.height.value;
  var border = frm.border.value;
  var alt = frm.alt.value;
  var align = frm.valalign.value;
  var hspace = frm.hspace.value;
  var vspace = frm.vspace.value;

  var img = '<img src="' + path + '"';
  if (alt)
   img += ' alt="' + alt + '" title="' + alt + '"';
  if (border)
   img += ' border="' + border + '"';
  if (width)
    img += ' width="' + width + '"';
  if (height)
    img += ' height="' + height + '"';
  if (align)
    img += ' align="' + align + '"';
  if (vspace)
    img += ' vspace="' + vspace + '"';
  if (hspace)
    img += ' hspace="' + hspace + '"';
  img += '>';
  frm.filepath.value = '';
  frm.width.value = '';
  frm.height.value = '';
  frm.border.value = '';
  frm.alt.value = '';
  hideImgProp()

  if (parent.prevRangeType == 'Control'){
    var ne = parent.document.createElement(img);
    parent.prevRange(0).replaceNode(ne);
  }else{
     parent.prevRange.pasteHTML(img);
  }
  parent.popupToggle(parent.document.all.image);
  parent.document.all.ewe.focus();
}
</script>
<style>
img.image{
  cursor: pointer;
}
</style>
<link REL="StyleSheet" TYPE="text/css" HREF="popup.css">
</head>
<body style="background-color:#FFFFFF;overflow:hidden;" onClick="parent.popupClick(parent.document.all.image);" unselectable="on">
  
<table id="tblContainer" border=1 cellpadding="2" cellspacing="0" unselectable="on">
  <tr unselectable="on" > 
	<td style="border:1px solid #FFFFFF;" unselectable="on"  valign="middle" align="center"><img src="../emoticons/fcuppa08.gif" width="21" height="21" class="image" onClick="loadImgProp(this, 'emoticons/fcuppa08.gif');"></td>
	<td style="border:1px solid #FFFFFF;" unselectable="on"  valign="middle" align="center"><img src="../emoticons/msbuaah.gif" width="19" height="19" class="image" onClick="loadImgProp(this, '/emoticons/msbuaah.gif');"></td>
	<td style="border:1px solid #FFFFFF;" unselectable="on"  valign="middle" align="center"><img src="../emoticons/mscool.gif" width="19" height="19" class="image" onClick="loadImgProp(this, 'emoticons/mscool.gif');"></td>
	<td style="border:1px solid #FFFFFF;" unselectable="on"  valign="middle" align="center"><img src="../emoticons/msdelite.gif" width="19" height="19" class="image" onClick="loadImgProp(this, 'emoticons/msdelite.gif');"></td>
	<td style="border:1px solid #FFFFFF;" unselectable="on"  valign="middle" align="center"><img src="../emoticons/mserrr.gif" width="19" height="19" class="image" onClick="loadImgProp(this, 'emoticons/mserrr.gif');"></td>
	<td style="border:1px solid #FFFFFF;" unselectable="on"  valign="middle" align="center"><img src="../emoticons/mshalo.gif" width="17" height="19" class="image" onClick="loadImgProp(this, 'emoticons/mshalo.gif');"></td>
	<td style="border:1px solid #FFFFFF;" unselectable="on"  valign="middle" align="center"><img src="../emoticons/mshmmm.gif" width="19" height="19" class="image" onClick="loadImgProp(this, 'emoticons/mshmmm.gif');"></td>
	<td style="border:1px solid #FFFFFF;" unselectable="on"  valign="middle" align="center"><img src="../emoticons/msooh.gif" width="19" height="19" class="image" onClick="loadImgProp(this, 'emoticons/msooh.gif');"></td>
	<td style="border:1px solid #FFFFFF;" unselectable="on"  valign="middle" align="center"><img src="../emoticons/msperv-l.gif" width="19" height="19" class="image" onClick="loadImgProp(this, 'emoticons/msperv-l.gif');"></td>
	<td style="border:1px solid #FFFFFF;" unselectable="on"  valign="middle" align="center"><img src="../emoticons/msperv-r.gif" width="19" height="19" class="image" onClick="loadImgProp(this, 'emoticons/msperv-r.gif');"></td>
	<td style="border:1px solid #FFFFFF;" unselectable="on"  valign="middle" align="center"><img src="../emoticons/mssad.gif" width="19" height="19" class="image" onClick="loadImgProp(this, 'emoticons/mssad.gif');"></td>
	<td style="border:1px solid #FFFFFF;" unselectable="on"  valign="middle" align="center"><img src="../emoticons/mssmile.gif" width="19" height="19" class="image" onClick="loadImgProp(this, 'emoticons/mssmile.gif');"></td>
  </tr>
  <tr unselectable="on"> 
	<td style="border:1px solid #FFFFFF;" unselectable="on"  valign="middle" align="center"><img src="../emoticons/mswhat.gif" width="19" height="19" class="image" onClick="loadImgProp(this, 'emoticons/mswhat.gif');"></td>
	<td style="border:1px solid #FFFFFF;" unselectable="on"  valign="middle" align="center"><img src="../emoticons/mswink.gif" width="19" height="19" class="image" onClick="loadImgProp(this, 'emoticons/mswink.gif');"></td>
	<td style="border:1px solid #FFFFFF;" unselectable="on"  valign="middle" align="center"><img src="../emoticons/obaileys.gif" width="15" height="36" class="image" onClick="loadImgProp(this, 'emoticons/obaileys.gif');"></td>
	<td style="border:1px solid #FFFFFF;" unselectable="on"  valign="middle" align="center"><img src="../emoticons/ocone.gif" width="23" height="16" class="image" onClick="loadImgProp(this, 'emoticons/ocone.gif');"></td>
	<td style="border:1px solid #FFFFFF;" unselectable="on"  valign="middle" align="center"><img src="../emoticons/s.heart.gif" width="16" height="16" class="image" onClick="loadImgProp(this, 'emoticons/s.heart.gif');"></td>
	<td style="border:1px solid #FFFFFF;" unselectable="on"  valign="middle" align="center"><img src="../emoticons/s.question.gif" width="16" height="16" class="image" onClick="loadImgProp(this, 'emoticons/s.question.gif');"></td>
	<td style="border:1px solid #FFFFFF;" unselectable="on"  valign="middle" align="center"><img src="../emoticons/wsaint.gif" width="15" height="19" class="image" onClick="loadImgProp(this, 'emoticons/wsaint.gif');"></td>
	<td style="border:1px solid #FFFFFF;" unselectable="on"  valign="middle" align="center"><img src="../emoticons/yelvis.gif" width="15" height="15" class="image" onClick="loadImgProp(this, 'emoticons/yelvis.gif');"></td>
	<td style="border:1px solid #FFFFFF;" unselectable="on"  valign="middle" align="center"><img src="../emoticons/oballoon.gif" width="17" height="18" class="image" onClick="loadImgProp(this, 'emoticons/oballoon.gif');"></td>
	<td style="border:1px solid #FFFFFF;" unselectable="on"  valign="middle" align="center"><img src="../emoticons/opeace.gif" width="15" height="15" class="image" onClick="loadImgProp(this, 'emoticons/opeace.gif');"></td>
	<td style="border:1px solid #FFFFFF;" unselectable="on"  valign="middle" align="center"><img src="../emoticons/ovenus.gif" width="12" height="16" class="image" onClick="loadImgProp(this, 'emoticons/ovenus.gif');"></td>
	<td style="border:1px solid #FFFFFF;" unselectable="on"  valign="middle" align="center"><img src="../emoticons/ribgreen.gif" width="10" height="15" class="image" onClick="loadImgProp(this, 'emoticons/ribgreen.gif');"></td>
  </tr>
</table>
  <div id="imgProperties" style="visibility:hidden;">
  <form name="frmProp" onSubmit="return false;" unselectable="on">
  <input type="hidden" name="filepath">
  <table width="350" border="0" cellspacing="0" cellpadding="1" unselectable="on">
    <tr unselectable="on">
      <td width="350" class="columnHeader" style="font-weight: 600;" unselectable="on" colspan="3">Image Properties - <a href="#" onClick="hideImgProp();return false;">hide</a> <hr size="1" noshad></td>
    </tr>
    <tr unselectable="on">
      <td width="15" unselectable="on">&nbsp;</td>
      <td width="135" class="columnHeader" unselectable="on">Width: </td>
      <td width="200" unselectable="on"><input type="text" size="2" maxlength="4" name="width">px</td>
    </tr>
    <tr unselectable="on">
      <td width="15" unselectable="on">&nbsp;</td>
      <td width="135" class="columnHeader" unselectable="on">Height: </td>
      <td width="200" unselectable="on"><input type="text" size="2" maxlength="4" name="height">px</td>
    </tr>
    <tr unselectable="on">
      <td width="15" unselectable="on">&nbsp;</td>
      <td width="135" class="columnHeader" unselectable="on">Border Size: </td>
      <td width="200" unselectable="on"><input type="text" size="2" maxlength="4" name="border" value="0"></td>
    </tr>
    <tr unselectable="on">
      <td width="15" unselectable="on">&nbsp;</td>
      <td width="135" class="columnHeader" unselectable="on">Alternate Text: </td>
      <td width="200" unselectable="on"><input type="text" size="20" maxlength="100" name="alt"></td>
    </tr>
    <tr unselectable="on">
      <td width="15" unselectable="on">&nbsp;</td>
      <td width="135" class="columnHeader" unselectable="on">Align: </td>
      <td width="200" unselectable="on"><select name="valalign"><option value="">Default</option><option value="bottom">Bottom</option><option value="middle">Middle</option><option value="top">Top</option><option value="left">Left</option><option value="right">Right</option></td>
    </tr>
    <tr unselectable="on">
      <td width="15" unselectable="on">&nbsp;</td>
      <td width="135" class="columnHeader" unselectable="on">Horizontal Space: </td>
      <td width="200" unselectable="on"><input type="text" size="2" maxlength="4" name="hspace">px</td>
    </tr>
    <tr unselectable="on">
      <td width="15" unselectable="on">&nbsp;</td>
      <td width="135" class="columnHeader" unselectable="on">Vertical Space: </td>
      <td width="200" unselectable="on"><input type="text" size="2" maxlength="4" name="vspace">px</td>
    </tr>
    <tr unselectable="on">
      <td width="15" unselectable="on">&nbsp;</td>
      <td width="100" class="columnHeader" unselectable="on">&nbsp;</td>
      <td width="160" unselectable="on"><input type="button" value="Insert Image" onClick="insertImage();"></td>
    </tr>
  </table>
  </form>
  </div>
</body>
</html>